<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>PHP Manual: COM and .Net (Windows)</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td style="font-size: smaller;" width="15%">
<style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="index.html">PHP Manual</a></li>
  <li class="header up"><a href="funcref.html">Function Reference</a></li>
  <li class="header up"><a href="refs.utilspec.windows.html">Windows Only Extensions</a></li>
  <li class="active"><a href="book.com.html">COM</a></li>
  <li><a href="book.win32ps.html">win32ps</a></li>
  <li><a href="book.win32service.html">win32service</a></li>
 </ul>

        </td>
        <td width="85%">
            <div style="text-align: center;">
                <div class="prev" style="text-align: left; float: left;"><a href="refs.utilspec.windows.html">Windows Only Extensions</a></div>
                <div class="next" style="text-align: right; float: right;"><a href="intro.com.html">Introduction</a></div>
                <div class="up"><a href="refs.utilspec.windows.html">Windows Only Extensions</a></div>
                <div class="home"><a href="index.html">PHP Manual</a></div>
            </div><hr/>
<div id="book.com" class="book">
 
 <h1>COM and .Net (Windows)</h1><strong>Table of Contents</strong><ul class="chunklist chunklist_title">
<li><a href="intro.com.html">Introduction</a></li>
<li><a href="com.setup.html">Installing/Configuring</a><ul class="chunklist chunklist_title">
<li><a href="com.requirements.html">Requirements</a></li>
<li><a href="com.installation.html">Installation</a></li>
<li><a href="com.configuration.html">Runtime Configuration</a></li>
<li><a href="com.resources.html">Resource Types</a></li>
</ul>
</li>
<li><a href="com.constants.html">Predefined Constants</a></li>
<li><a href="com.error-handling.html">Errors and error handling</a></li>
<li><a href="com.examples.html">Examples</a><ul class="chunklist chunklist_title">
<li><a href="com.examples.foreach.html">For Each</a></li>
<li><a href="com.examples.arrays.html">Arrays and Array-style COM properties</a></li>
</ul>
</li>
<li><a href="class.com.html">COM</a> — The COM class</li>
<li><a href="class.dotnet.html">DOTNET</a> — The DOTNET class</li>
<li><a href="class.variant.html">VARIANT</a> — VARIANT class</li>
<li><a href="ref.com.html">COM Functions</a><ul class="chunklist chunklist_title">
<li><a href="function.com-create-guid.html">com_create_guid</a> — Generate a globally unique identifier (GUID)</li>
<li><a href="function.com-event-sink.html">com_event_sink</a> — Connect events from a COM object to a PHP object</li>
<li><a href="function.com-get-active-object.html">com_get_active_object</a> — Returns a handle to an already running instance of a COM object</li>
<li><a href="function.com-load-typelib.html">com_load_typelib</a> — Loads a Typelib</li>
<li><a href="function.com-message-pump.html">com_message_pump</a> — Process COM messages, sleeping for up to timeoutms milliseconds</li>
<li><a href="function.com-print-typeinfo.html">com_print_typeinfo</a> — Print out a PHP class definition for a dispatchable interface</li>
<li><a href="function.variant-abs.html">variant_abs</a> — Returns the absolute value of a variant</li>
<li><a href="function.variant-add.html">variant_add</a> — &quot;Adds&quot; two variant values together and returns the result</li>
<li><a href="function.variant-and.html">variant_and</a> — Performs a bitwise AND operation between two variants</li>
<li><a href="function.variant-cast.html">variant_cast</a> — Convert a variant into a new variant object of another type</li>
<li><a href="function.variant-cat.html">variant_cat</a> — concatenates two variant values together and returns the result</li>
<li><a href="function.variant-cmp.html">variant_cmp</a> — Compares two variants</li>
<li><a href="function.variant-date-from-timestamp.html">variant_date_from_timestamp</a> — Returns a variant date representation of a Unix timestamp</li>
<li><a href="function.variant-date-to-timestamp.html">variant_date_to_timestamp</a> — Converts a variant date/time value to Unix timestamp</li>
<li><a href="function.variant-div.html">variant_div</a> — Returns the result from dividing two variants</li>
<li><a href="function.variant-eqv.html">variant_eqv</a> — Performs a bitwise equivalence on two variants</li>
<li><a href="function.variant-fix.html">variant_fix</a> — Returns the integer portion of a variant</li>
<li><a href="function.variant-get-type.html">variant_get_type</a> — Returns the type of a variant object</li>
<li><a href="function.variant-idiv.html">variant_idiv</a> — Converts variants to integers and then returns the result from dividing them</li>
<li><a href="function.variant-imp.html">variant_imp</a> — Performs a bitwise implication on two variants</li>
<li><a href="function.variant-int.html">variant_int</a> — Returns the integer portion of a variant</li>
<li><a href="function.variant-mod.html">variant_mod</a> — Divides two variants and returns only the remainder</li>
<li><a href="function.variant-mul.html">variant_mul</a> — Multiplies the values of the two variants</li>
<li><a href="function.variant-neg.html">variant_neg</a> — Performs logical negation on a variant</li>
<li><a href="function.variant-not.html">variant_not</a> — Performs bitwise not negation on a variant</li>
<li><a href="function.variant-or.html">variant_or</a> — Performs a logical disjunction on two variants</li>
<li><a href="function.variant-pow.html">variant_pow</a> — Returns the result of performing the power function with two variants</li>
<li><a href="function.variant-round.html">variant_round</a> — Rounds a variant to the specified number of decimal places</li>
<li><a href="function.variant-set-type.html">variant_set_type</a> — Convert a variant into another type &quot;in-place&quot;</li>
<li><a href="function.variant-set.html">variant_set</a> — Assigns a new value for a variant object</li>
<li><a href="function.variant-sub.html">variant_sub</a> — Subtracts the value of the right variant from the left variant value</li>
<li><a href="function.variant-xor.html">variant_xor</a> — Performs a logical exclusion on two variants</li>
</ul>
</li>
</ul>

 
 
 
 
 
 
 







 





 




 



 



 
 <h1 class="title">The COM class</h1>
 <div class="partintro">

 <div class="section" id="class.com.class">
  <h2 class="title">Description</h2>
  <p class="simpara">
   The COM class allows you to instantiate an OLE compatible COM object and
   call its methods and access its properties.
  </p>
  <p class="simpara">
   <em>$obj = new COM(&quot;Application.ID&quot;)</em>
  </p>
 </div>
 <div class="section" id="com.com">
  <h2 class="title">Methods</h2>
  <div class="methodsynopsis dc-description">
    <span class="methodname">COM::__construct</span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$module_name</code></span>
   [, <span class="methodparam"><span class="type">mixed</span> <code class="parameter">$server_name</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$codepage</code></span>
   [, <span class="methodparam"><span class="type">string</span> <code class="parameter">$typelib</code></span>
  ]]] )</div>

  <p class="para">
   COM class constructor. The parameters have the following meanings:
   <dl>

    
     <dt>
module_name</dt>

     <dd>

      <span class="simpara">
       Can be a ProgID, Class ID or Moniker that names the component to load.
      </span>
      <span class="simpara">
       A ProgID is typically the application or DLL name, followed by a period,
       followed by the object name. e.g: <em>Word.Application</em>.
      </span>
      <span class="simpara">
       A Class ID is the UUID that uniquely identifies a given class.
      </span>
      <span class="simpara">
       A Moniker is a special form of naming, similar in concept to a URL
       scheme, that identifies a resource and specifies how it should be
       loaded.  As an example, you could load up Word and get an object
       representing a word document by specifying the full path to the word
       document as the module name, or you can use <em>LDAP:</em> as
       a moniker to use the ADSI interface to LDAP.
      </span>
     </dd>

    
    
     <dt>
server_name</dt>

     <dd>

      <span class="simpara">
       The name of the DCOM server on which the component should be loaded and
       run.  If <strong><code>NULL</code></strong>, the object is run using the default for the
       application.  The default is typically to run it on the local machine,
       although the administrator might have configured the application to
       launch on a different machine.
      </span>
      <span class="simpara">
       If you specify a non-<strong><code>NULL</code></strong> value for server, PHP will refuse to load
       the object unless the <a href="com.configuration.html#ini.com.allow-dcom" class="xref"></a> configuration option
       is set to <strong><code>TRUE</code></strong>.
      </span>
      <p class="para">
       If <code class="parameter">server_name</code> is an array, it should contain the
       following elements (case sensitive!).  Note that they are all optional
       (although you need to specify both Username and Password together); if
       you omit the Server setting, the default server will be used (as
       mentioned above), and the instantiation of the object will not be
       affected by the <a href="com.configuration.html#ini.com.allow-dcom" class="xref"></a>
       directive.
       <table class="doctable table">
        <caption><strong>DCOM server name</strong></caption>
        
         <thead>
          <tr>
           <th><code class="parameter">server_name</code> key</th>
           <th>type</th>
           <th>description</th>
          </tr>

         </thead>

         <tbody class="tbody">
          <tr>
           <td>Server</td>
           <td>string</td>
           <td>The name of the server.</td>
          </tr>

          <tr>
           <td>Username</td>
           <td>string</td>
           <td>The username to connect as.</td>
          </tr>

          <tr>
           <td>Password</td>
           <td>string</td>
           <td>The password for <code class="parameter">Username</code>.</td>
          </tr>

          <tr>
           <td>Flags</td>
           <td>integer</td>
           <td>One or more of the following constants, logically OR&#039;d together:
            <strong><code>CLSCTX_INPROC_SERVER</code></strong>,
            <strong><code>CLSCTX_INPROC_HANDLER</code></strong>,
            <strong><code>CLSCTX_LOCAL_SERVER</code></strong>,
            <strong><code>CLSCTX_REMOTE_SERVER</code></strong>,
            <strong><code>CLSCTX_SERVER</code></strong> and
            <strong><code>CLSCTX_ALL</code></strong>.  The default value if not
            specified here is <strong><code>CLSCTX_SERVER</code></strong> if you also
            omit <code class="parameter">Server</code>, or
            <strong><code>CLSCTX_REMOTE_SERVER</code></strong> if you do specify a
            server.  You should consult the Microsoft documentation for
            CoCreateInstance for more information on the meaning of these
            constants; you will typically never have to use them.
           </td>
          </tr>

         </tbody>
        
       </table>

      </p>
     </dd>

    
    
     <dt>
codepage</dt>

     <dd>

      <span class="simpara">
       Specifies the codepage that is used to convert strings to
       unicode-strings and vice versa.  The conversion is applied whenever a
       PHP string is passed as a parameter or returned from a method of this
       COM object.  The code page is sticky in PHP 5, which means that it will
       propagate to objects and variants returned from the object.
      </span>
      <span class="simpara">
       Possible values are
       <strong><code>CP_ACP</code></strong> (use system default ANSI code page - the
       default if this parameter is omitted),
       <strong><code>CP_MACCP</code></strong>,
       <strong><code>CP_OEMCP</code></strong>, <strong><code>CP_SYMBOL</code></strong>,
       <strong><code>CP_THREAD_ACP</code></strong> (use codepage/locale set for the
       current executing thread), <strong><code>CP_UTF7</code></strong>
       and <strong><code>CP_UTF8</code></strong>.  You may also use the number for a
       given codepage; consult the Microsoft documentation for more details on
       codepages and their numeric values.
      </span>
     </dd>

    
   </dl>

  </p>
 </div>

 <div class="section" id="class.com.overloadedmethods">
  <h2 class="title">Overloaded Methods</h2>
  <p class="para">
   The returned object is an overloaded object, which means that PHP does
   not see any fixed methods as it does with regular classes; instead, any
   property or method accesses are passed through to COM.
  </p>
  <p class="para">
   Starting with PHP 5, PHP will automatically detect methods that accept
   parameters by reference, and will automatically convert regular PHP
   variables to a form that can be passed by reference.  This means that you
   can call the method very naturally; you needn&#039;t go to any extra effort in
   your code.
  </p>
 </div>

 <div class="section" id="class.com.falsemethods">
  <h2 class="title">Pseudo Methods</h2>
  <p class="para">
   In PHP versions prior to 5, a number of not very pleasant hacks meant that
   the following method names were not passed through to COM and were handled
   directly by PHP.  PHP 5 eliminates these things; read the details below to
   determine how to fix your scripts.  These magic method names are case
   insensitive.
  </p>
  <div class="methodsynopsis dc-description" id="com.addref">
   <span class="type">void</span> <span class="methodname">COM::AddRef</span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Artificially adds a reference count to the COM object.
  </p>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
    You should never need to use this method. It exists as a logical complement
    to the Release() method below.
   </p>
  </div>
  <div class="methodsynopsis dc-description" id="com.release">
   <span class="type">void</span> <span class="methodname">COM::Release</span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Artificially removes a reference count from the COM object.
  </p>
  <div class="warning"><strong class="warning">Warning</strong>
   <p class="simpara">
    You should never need to use this method.  Its existence in PHP is a bug
    designed to work around a bug that keeps COM objects running longer than
    they should.
   </p>
  </div>
 </div>
 <div class="section" id="class.com.iteratormethods">
  <h2 class="title">Pseudo Methods for Iterating</h2>
  <p class="para">
   These pseudo methods are only available if
   <span class="function">com_isenum</span> returns <strong><code>TRUE</code></strong>, in which case, they hide
   any methods with the same names that might otherwise be provided by the
   COM object.  These methods have all been eliminated in PHP 5, and you
   should use <a href="com.examples.foreach.html" class="xref">For Each</a> instead.
  </p>
  <div class="methodsynopsis dc-description" id="com.all">
   <span class="type">variant</span> <span class="methodname">COM::All</span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Returns a variant representing a SafeArray that has 10 elements;
   each element will be an empty/null variant.  This function was supposed to
   return an array containing all the elements from the iterator, but was
   never completed.  Do not use.
  </p>
  <div class="methodsynopsis dc-description" id="com.next">
   <span class="type">variant</span> <span class="methodname">COM::Next</span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Returns a variant representing the next element available from
   the iterator, or <strong><code>FALSE</code></strong> when there are no more elements.
  </p>
  <div class="methodsynopsis dc-description" id="com.prev">
   <span class="type">variant</span> <span class="methodname">COM::Prev</span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">Returns a variant representing the previous element available from
   the iterator, or <strong><code>FALSE</code></strong> when there are no more elements.
  </p>
  <div class="methodsynopsis dc-description" id="com.reset">
   <span class="type">void</span> <span class="methodname">COM::Reset</span>
    ( <span class="methodparam">void</span>
   )</div>

  <p class="simpara">
   Rewinds the iterator back to the start.
  </p>
 </div>
 <div class="section" id="class.com.examples">
  <h2 class="title">COM examples</h2>
  <p class="para">
   <div class="example" id="example-6232">
    <p><strong>Example #1 COM example (1)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">//&nbsp;starting&nbsp;word<br /></span><span style="color: #0000BB">$word&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"word.application"</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Unable&nbsp;to&nbsp;instantiate&nbsp;Word"</span><span style="color: #007700">);<br />echo&nbsp;</span><span style="color: #DD0000">"Loaded&nbsp;Word,&nbsp;version&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Version</span><span style="color: #007700">}</span><span style="color: #DD0000">\n"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//bring&nbsp;it&nbsp;to&nbsp;front<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Visible&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//open&nbsp;an&nbsp;empty&nbsp;document<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Documents</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Add</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//do&nbsp;some&nbsp;weird&nbsp;stuff<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Selection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">TypeText</span><span style="color: #007700">(</span><span style="color: #DD0000">"This&nbsp;is&nbsp;a&nbsp;test..."</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Documents</span><span style="color: #007700">[</span><span style="color: #0000BB">1</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">SaveAs</span><span style="color: #007700">(</span><span style="color: #DD0000">"Useless&nbsp;test.doc"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//closing&nbsp;word<br /></span><span style="color: #0000BB">$word</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Quit</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//free&nbsp;the&nbsp;object<br /></span><span style="color: #0000BB">$word&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-6233">
    <p><strong>Example #2 COM example (2)</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$conn&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">COM</span><span style="color: #007700">(</span><span style="color: #DD0000">"ADODB.Connection"</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Cannot&nbsp;start&nbsp;ADO"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Open</span><span style="color: #007700">(</span><span style="color: #DD0000">"Provider=SQLOLEDB;&nbsp;Data&nbsp;Source=localhost;<br />Initial&nbsp;Catalog=database;&nbsp;User&nbsp;ID=user;&nbsp;Password=password"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$rs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Execute</span><span style="color: #007700">(</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;sometable"</span><span style="color: #007700">);&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Recordset<br /><br /></span><span style="color: #0000BB">$num_columns&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Fields</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Count</span><span style="color: #007700">();<br />echo&nbsp;</span><span style="color: #0000BB">$num_columns&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br /><br />for&nbsp;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$num_columns</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$fld</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Fields</span><span style="color: #007700">(</span><span style="color: #0000BB">$i</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #0000BB">$rowcount&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />while&nbsp;(!</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">EOF</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(</span><span style="color: #0000BB">$i</span><span style="color: #007700">=</span><span style="color: #0000BB">0</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i&nbsp;</span><span style="color: #007700">&lt;&nbsp;</span><span style="color: #0000BB">$num_columns</span><span style="color: #007700">;&nbsp;</span><span style="color: #0000BB">$i</span><span style="color: #007700">++)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$fld</span><span style="color: #007700">[</span><span style="color: #0000BB">$i</span><span style="color: #007700">]-&gt;</span><span style="color: #0000BB">value&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"\t"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rowcount</span><span style="color: #007700">++;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;increments&nbsp;rowcount<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">MoveNext</span><span style="color: #007700">();<br />}<br /><br /></span><span style="color: #0000BB">$rs</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Close</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Close</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">$rs&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$conn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">null</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
 </div>

 </div>




 


 
 <h1 class="title">The DOTNET class</h1>
 <div class="partintro">

 <div class="section" id="class.dotnet.class">
  <h2 class="title">Description</h2>
  <p class="simpara">
   The DOTNET class allows you to instantiate a class from a .Net assembly and
   call its methods and access its properties.
  </p>
  <p class="simpara">
   <em>$obj = new DOTNET(&quot;assembly&quot;, &quot;classname&quot;)</em>
  </p>
 </div>
 <div class="section" id="dotnet.dotnet">
  <h2 class="title">Methods</h2>
  <div class="methodsynopsis dc-description">
    <span class="methodname">DOTNET::__construct</span>
    ( <span class="methodparam"><span class="type">string</span> <code class="parameter">$assembly_name</code></span>
   , <span class="methodparam"><span class="type">string</span> <code class="parameter">$class_name</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$codepage</code></span>
  ] )</div>

  <p class="para">
   DOTNET class constructor.  <code class="parameter">assembly_name</code> specifies
   which assembly should be loaded, and <code class="parameter">class_name</code>
   specifices which class in that assembly to instantiate.  You may
   optionally specify a <code class="parameter">codepage</code> to use for unicode
   string transformations; see the <a href="class.com.html" class="xref">COM</a> class
   for more details on code pages.
  </p>
  <p class="para">
   The returned object is an overloaded object, which means that PHP does
   not see any fixed methods as it does with regular classes; instead, any
   property or method accesses are passed through to COM and from there to
   DOTNET.  In other words, the .Net object is mapped through the COM
   interoperability layer provided by the .Net runtime.
  </p>
  <p class="para">
   Once you have created a DOTNET object, PHP treats it identically to any
   other COM object; all the same rules apply.
  </p>
  <p class="para">
   <div class="example" id="example-6234">
    <p><strong>Example #3 DOTNET example</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />&nbsp;$stack&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">DOTNET</span><span style="color: #007700">(</span><span style="color: #DD0000">"mscorlib"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"System.Collections.Stack"</span><span style="color: #007700">);<br />&nbsp;</span><span style="color: #0000BB">$stack</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Push</span><span style="color: #007700">(</span><span style="color: #DD0000">".Net"</span><span style="color: #007700">);<br />&nbsp;</span><span style="color: #0000BB">$stack</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Push</span><span style="color: #007700">(</span><span style="color: #DD0000">"Hello&nbsp;"</span><span style="color: #007700">);<br />&nbsp;echo&nbsp;</span><span style="color: #0000BB">$stack</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Pop</span><span style="color: #007700">()&nbsp;.&nbsp;</span><span style="color: #0000BB">$stack</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">Pop</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    You need to install the .Net runtime on your web server to take advantage
    of this feature.
   </p>
  </p></blockquote>
 </div>

 </div>




 


 
 <h1 class="title">VARIANT class</h1>
 <div class="partintro">

 <div class="section" id="class.variant.class">
  <h2 class="title">Description</h2>
  <p class="simpara">
   The VARIANT is COM&#039;s equivalent of the PHP zval; it is a structure that
   can contain a value with a range of different possible types.  The VARIANT
   class provided by the COM extension allows you to have more control over
   the way that PHP passes values to and from COM.
  </p>
  <p class="simpara">
   <em>$vVar = new VARIANT($var)</em>
  </p>
 </div>
 <div class="section" id="variant.variant">
  <h2 class="title">Methods</h2>
  <div class="methodsynopsis dc-description">
    <span class="methodname">VARIANT::__construct</span>
    ([ <span class="methodparam"><span class="type">mixed</span> <code class="parameter">$value</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$type</code></span>
   [, <span class="methodparam"><span class="type">int</span> <code class="parameter">$codepage</code></span>
  ]]] )</div>

  <p class="para">
   VARIANT class constructor. Parameters:
   <dl>

   <dt>
value</dt>

   <dd>

    <span class="simpara">
     initial value. if omitted, or set to <strong><code>NULL</code></strong> an VT_EMPTY object is created.
    </span>
   </dd>

   
   <dt>
type</dt>

   <dd>

    <span class="simpara">
     specifies the content type of the VARIANT object. Possible values are
     one of the <strong><code>VT_XXX</code></strong> <a href="com.constants.html" class="xref">Predefined Constants</a>.
    </span>
    <span class="simpara">
     In PHP versions prior to PHP 5, you could force PHP to pass a variant
     object by reference by OR&#039;ing <strong><code>VT_BYREF</code></strong>
     with the <code class="parameter">type</code>.  In PHP 5, this hack is not
     supported; instead, PHP 5 can detect parameters passed by reference
     automatically; they do not even need to be passed as VARIANT objects.
    </span>
    <span class="simpara">
     Consult the <acronym class="acronym">MSDN</acronym> library for additional information
     on the VARIANT type.
    </span>
   </dd>

   
   <dt>
codepage</dt>

   <dd>

    <span class="simpara">
     specifies the codepage that is used to convert strings to
     unicode.  See the parameter of the same name in the
     <a href="class.com.html" class="xref">COM</a> class for more information.
    </span>
   </dd>

   
   </dl>

  </p>
  <p class="para">
   PHP versions prior to PHP 5 define a number of (undocumented) virtual properties
   for instances of the VARIANT class; these properties have all been removed in
   PHP 5 in favour of its more natural syntax; these differences are best
   highlighted by example:
  </p>
  <p class="para">
   <div class="example" id="example-6235">
    <p><strong>Example #4 Variant example, PHP 4.x style</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$v&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">42</span><span style="color: #007700">);<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;type&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">type&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;value&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$v</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">value&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   <div class="example" id="example-6236">
    <p><strong>Example #5 Variant example, PHP 5 style</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br />$v&nbsp;</span><span style="color: #007700">=&nbsp;new&nbsp;</span><span style="color: #0000BB">VARIANT</span><span style="color: #007700">(</span><span style="color: #0000BB">42</span><span style="color: #007700">);<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;type&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">variant_get_type</span><span style="color: #007700">(</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br />print&nbsp;</span><span style="color: #DD0000">"The&nbsp;value&nbsp;is&nbsp;"&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$v&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">"&lt;br/&gt;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

   </div>
  </p>
  <p class="para">
   The reason for the change is that, internally, the COM extension sees
   VARIANT, COM and DOTNET classes as the same thing, and the design
   philosophy for these classes is that all property and member accesses are
   passed through to COM with no interference.  The new syntax is more
   natural and less effort, and most of the removed virtual properties didn&#039;t
   make any sense in a PHP context in any case.
  </p>
  <blockquote class="note"><p><strong class="note">Note</strong>: 
   <p class="para">
    PHP 5 takes a much simpler approach to handling VARIANTs; when returning
    a value or fetching a variant property, the variant is converted to a PHP
    value only when there is a direct mapping between the types that would
    not result in a loss of information.  In all other cases, the result is
    returned as an instance of the VARIANT class.  You can force PHP to
    convert or evaluate the variant as a PHP native type by using a casting
    operator explicitly, or implicitly casting to a string by
    <span class="function">print</span>ing it.  You may use the wide range of variant
    functions to perform arithmetic operations on variants without forcing a
    conversion or risking a loss of data.
   </p>
  </p></blockquote>
  <p class="para">
   See also <span class="function">variant_get_type</span>.
  </p>
 </div>

 </div>




 








</div>
        </td>
    </tr>
</table>
</body>
</html>
