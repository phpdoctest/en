<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>PHP Manual: Saves a document to this collection</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td style="font-size: smaller;" width="15%">
<style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="index.html">PHP Manual</a></li>
  <li class="header up"><a href="funcref.html">Function Reference</a></li>
  <li class="header up"><a href="refs.database.html">Database Extensions</a></li>
  <li class="header up"><a href="refs.database.vendors.html">Vendor Specific Database Extensions</a></li>
  <li class="header up"><a href="book.mongo.html">Mongo</a></li>
  <li class="header up"><a href="mongo.core.html">Core Classes</a></li>
  <li class="header up"><a href="class.mongocollection.html">MongoCollection</a></li>
  <li><a href="mongocollection.aggregate.html">MongoCollection::aggregate</a></li>
  <li><a href="mongocollection.aggregatecursor.html">MongoCollection::aggregateCursor</a></li>
  <li><a href="mongocollection.batchinsert.html">MongoCollection::batchInsert</a></li>
  <li><a href="mongocollection.construct.html">MongoCollection::__construct</a></li>
  <li><a href="mongocollection.count.html">MongoCollection::count</a></li>
  <li><a href="mongocollection.createdbref.html">MongoCollection::createDBRef</a></li>
  <li><a href="mongocollection.createindex.html">MongoCollection::createIndex</a></li>
  <li><a href="mongocollection.deleteindex.html">MongoCollection::deleteIndex</a></li>
  <li><a href="mongocollection.deleteindexes.html">MongoCollection::deleteIndexes</a></li>
  <li><a href="mongocollection.distinct.html">MongoCollection::distinct</a></li>
  <li><a href="mongocollection.drop.html">MongoCollection::drop</a></li>
  <li><a href="mongocollection.ensureindex.html">MongoCollection::ensureIndex</a></li>
  <li><a href="mongocollection.find.html">MongoCollection::find</a></li>
  <li><a href="mongocollection.findandmodify.html">MongoCollection::findAndModify</a></li>
  <li><a href="mongocollection.findone.html">MongoCollection::findOne</a></li>
  <li><a href="mongocollection.get.html">MongoCollection::__get</a></li>
  <li><a href="mongocollection.getdbref.html">MongoCollection::getDBRef</a></li>
  <li><a href="mongocollection.getindexinfo.html">MongoCollection::getIndexInfo</a></li>
  <li><a href="mongocollection.getname.html">MongoCollection::getName</a></li>
  <li><a href="mongocollection.getreadpreference.html">MongoCollection::getReadPreference</a></li>
  <li><a href="mongocollection.getslaveokay.html">MongoCollection::getSlaveOkay</a></li>
  <li><a href="mongocollection.getwriteconcern.html">MongoCollection::getWriteConcern</a></li>
  <li><a href="mongocollection.group.html">MongoCollection::group</a></li>
  <li><a href="mongocollection.insert.html">MongoCollection::insert</a></li>
  <li><a href="mongocollection.parallelcollectionscan.html">MongoCollection::parallelCollectionScan</a></li>
  <li><a href="mongocollection.remove.html">MongoCollection::remove</a></li>
  <li class="active"><a href="mongocollection.save.html">MongoCollection::save</a></li>
  <li><a href="mongocollection.setreadpreference.html">MongoCollection::setReadPreference</a></li>
  <li><a href="mongocollection.setslaveokay.html">MongoCollection::setSlaveOkay</a></li>
  <li><a href="mongocollection.setwriteconcern.html">MongoCollection::setWriteConcern</a></li>
  <li><a href="mongocollection.toindexstring.html">MongoCollection::toIndexString</a></li>
  <li><a href="mongocollection.--tostring.html">MongoCollection::__toString</a></li>
  <li><a href="mongocollection.update.html">MongoCollection::update</a></li>
  <li><a href="mongocollection.validate.html">MongoCollection::validate</a></li>
 </ul>

        </td>
        <td width="85%">
            <div style="text-align: center;">
                <div class="prev" style="text-align: left; float: left;"><a href="mongocollection.remove.html">MongoCollection::remove</a></div>
                <div class="next" style="text-align: right; float: right;"><a href="mongocollection.setreadpreference.html">MongoCollection::setReadPreference</a></div>
                <div class="up"><a href="class.mongocollection.html">MongoCollection</a></div>
                <div class="home"><a href="index.html">PHP Manual</a></div>
            </div><hr/>
<div id="mongocollection.save" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">MongoCollection::save</h1>
  <p class="refpurpose">Saves a document to this collection</p>
 </div>

 <div class="refsect1 description" id="refsect1-mongocollection.save-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="type">mixed</span> <span class="methodname">MongoCollection::save</span>
    ( <span class="methodparam"><span class="type">array|object</span> <code class="parameter">$document</code></span>
   [, <span class="methodparam"><span class="type">array</span> <code class="parameter">$options</code><span class="initializer"> = array()</span></span>
  ] )</div>

  <p class="para rdfs-comment">
   If the object is from the database, update the existing database object, otherwise 
   insert this object.
  </p>
 </div>


 <div class="refsect1 parameters" id="refsect1-mongocollection.save-parameters">
  <h3 class="title">Parameters</h3>    
  <p class="para">
   <dl>

    
     <dt>

      <code class="parameter">document</code>
     </dt>

     <dd>

      <p class="para">
       Array or object to save. If an object is used, it may not have protected
       or private properties.
      </p>
      <blockquote class="note"><p><strong class="note">Note</strong>: 
       <p class="para">
        If the parameter does not have an <em>_id</em> key or
        property, a new <span class="classname">MongoId</span> instance will be created
        and assigned to it. See <span class="function">MongoCollection::insert</span> for
        additional information on this behavior.
       </p>
      </p></blockquote>
     </dd>

    
    
     <dt>

      <code class="parameter">options</code>
     </dt>

     <dd>

      <p class="para">
       Options for the save.
       <ul class="itemizedlist">
        <li class="listitem"><p class="para"><em>&quot;fsync&quot;</em></p><p class="para">Boolean, defaults to <strong><code>FALSE</code></strong>. If journaling is enabled, it works exactly like <em>&quot;j&quot;</em>. If journaling is not enabled, the write operation blocks until it is synced to database files on disk. If <strong><code>TRUE</code></strong>, an acknowledged insert is implied and this option will override setting <em>&quot;w&quot;</em> to <em>0</em>.</p><blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">If journaling is enabled, users are strongly encouraged to use the <em>&quot;j&quot;</em> option instead of <em>&quot;fsync&quot;</em>. Do not use <em>&quot;fsync&quot;</em> and <em>&quot;j&quot;</em> simultaneously, as that will result in an error.</span></p></blockquote></li>
        <li class="listitem"><p class="para"><em>&quot;j&quot;</em></p><p class="para">Boolean, defaults to <strong><code>FALSE</code></strong>. Forces the write operation to block until it is synced to the journal on disk. If <strong><code>TRUE</code></strong>, an acknowledged write is implied and this option will override setting <em>&quot;w&quot;</em> to <em>0</em>.</p><blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara">If this option is used and journaling is disabled, MongoDB 2.6+ will raise an error and the write will fail; older server versions will simply ignore the option.</span></p></blockquote></li>
        <li class="listitem"><p class="para"><em>&quot;socketTimeoutMS&quot;</em></p><p class="para">This option specifies the time limit, in milliseconds, for socket communication. If the server does not respond within the timeout period, a <span class="classname">MongoCursorTimeoutException</span> will be thrown and there will be no way to determine if the server actually handled the write or not. A value of <em>-1</em> may be specified to block indefinitely. The default value for <span class="classname">MongoClient</span> is <em>30000</em> (30 seconds).</p></li>
        <li class="listitem"><p class="para"><em>&quot;w&quot;</em></p><p class="para">See <a href="mongo.writeconcerns.html" class="link">Write Concerns</a>. The default value for <span class="classname">MongoClient</span> is <em>1</em>.</p></li>
        <li class="listitem"><p class="para"><em>&quot;wtimeout&quot;</em></p><p class="para">Deprecated alias for <em>&quot;wTimeoutMS&quot;</em>.</p></li>
        <li class="listitem"><p class="para"><em>&quot;wTimeoutMS&quot;</em></p><p class="para">This option specifies the time limit, in milliseconds, for <a href="mongo.writeconcerns.html" class="link">write concern</a> acknowledgement. It is only applicable when <em>&quot;w&quot;</em> is greater than <em>1</em>, as the timeout pertains to replication. If the write concern is not satisfied within the time limit, a <span class="classname">MongoCursorException</span> will be thrown. A value of <em>0</em> may be specified to block indefinitely. The default value for <span class="classname">MongoClient</span> is <em>10000</em> (ten seconds).</p></li>
        <li class="listitem"><p class="para"><em>&quot;safe&quot;</em></p><p class="para">Deprecated. Please use the <a href="mongo.writeconcerns.html" class="link">write concern</a> <em>&quot;w&quot;</em> option.</p></li>
        <li class="listitem"><p class="para"><em>&quot;timeout&quot;</em></p><p class="para">Deprecated alias for <em>&quot;socketTimeoutMS&quot;</em>.</p></li>
       </ul>
      </p>
     </dd>

       
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-mongocollection.save-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   If <code class="parameter">w</code> was set, returns an array containing the status of the save.
   Otherwise, returns a boolean representing if the array was not empty (an empty array will not 
   be inserted).
  </p>
 </div>


 <div class="refsect1 errors" id="refsect1-mongocollection.save-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   Throws <span class="classname">MongoException</span> if the inserted document is
   empty or if it contains zero-length keys. Attempting to insert an object with
   protected and private properties will cause a zero-length key error.
  </p>
  <p class="para">Throws <span class="classname">MongoCursorException</span> if the <em>&quot;w&quot;</em> option is set and the write fails.</p><p class="para">Throws <span class="classname">MongoCursorTimeoutException</span> if the <em>&quot;w&quot;</em> option is set to a value greater than one and the operation takes longer than <var class="varname">MongoCursor::$timeout</var> milliseconds to complete.  This does not kill the operation on the server, it is a client-side timeout. The operation in <var class="varname">MongoCollection::$wtimeout</var> is milliseconds.</p>
 </div>


 <div class="refsect1 changelog" id="refsect1-mongocollection.save-changelog">
  <h3 class="title">Changelog</h3>
  <p class="para">
   <table class="doctable informaltable">
    
     <thead>
      <tr>
       <th>Version</th>
       <th>Description</th>
      </tr>

     </thead>

     <tbody class="tbody">
      <tr>
       <td>1.5.0</td>
       <td>
        <p class="para">
         Added <em>&quot;wTimeoutMS&quot;</em> option, which replaces
         <em>&quot;wtimeout&quot;</em>. Emits <strong><code>E_DEPRECATED</code></strong>
         when <em>&quot;wtimeout&quot;</em> is used.
        </p>
        <p class="para">
         Added <em>&quot;socketTimeoutMS&quot;</em> option, which replaces
         <em>&quot;timeout&quot;</em>. Emits <strong><code>E_DEPRECATED</code></strong>
         when <em>&quot;timeout&quot;</em> is used.
        </p>
        <p class="para">
         Emits <strong><code>E_DEPRECATED</code></strong> when <em>&quot;safe&quot;</em>
         is used.
        </p>
       </td>
      </tr>

      <tr>
       <td>1.2.0</td>
       <td>Added <em>&quot;timeout&quot;</em> option.</td>
      </tr>

      <tr>
       <td>1.0.11</td>
       <td>
        Disconnects on &quot;not master&quot; errors if <em>&quot;safe&quot;</em> is set.
       </td>
      </tr>

      <tr>
       <td>1.0.9</td>
       <td>
        <p class="para">
         Added <em>&quot;fsync&quot;</em> option.
        </p>
       </td>
      </tr>

      <tr>
       <td>1.0.5</td>
       <td>Added <code class="parameter">options</code> parameter.</td>
      </tr>

     </tbody>
    
   </table>

  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-mongocollection.save-examples">
  <h3 class="title">Examples</h3>
  <div class="example" id="mongocollection.findandmodify.example.error">
   <p><strong>Example #1 <span class="function">MongoCollection::save</span> example</strong></p>
   <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />$obj&nbsp;</span><span style="color: #007700">=&nbsp;array(</span><span style="color: #DD0000">'x'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;insert&nbsp;$obj&nbsp;into&nbsp;the&nbsp;db<br /></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">(</span><span style="color: #0000BB">$obj</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$obj</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;add&nbsp;another&nbsp;field<br /></span><span style="color: #0000BB">$obj</span><span style="color: #007700">[</span><span style="color: #DD0000">'foo'</span><span style="color: #007700">]&nbsp;=&nbsp;</span><span style="color: #DD0000">'bar'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;$obj&nbsp;cannot&nbsp;be&nbsp;inserted&nbsp;again,&nbsp;causes&nbsp;duplicate&nbsp;_id&nbsp;error<br /></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">insert</span><span style="color: #007700">(</span><span style="color: #0000BB">$obj</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;save&nbsp;updates&nbsp;$obj&nbsp;with&nbsp;the&nbsp;new&nbsp;field<br /></span><span style="color: #0000BB">$collection</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">save</span><span style="color: #007700">(</span><span style="color: #0000BB">$obj</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
   </div>

   <div class="example-contents"><p>The above example will output
something similar to:</p></div>
   <div class="example-contents screen">
<div class="cdata"><pre>
array(2) {
  [&quot;x&quot;]=&gt;
  int(1)
  [&quot;_id&quot;]=&gt;
  object(MongoId)#4 (1) {
    [&quot;$id&quot;]=&gt;
    string(24) &quot;50b6afe544415ed606000000&quot;
  }
}
</pre></div>
   </div>
  </div>
 </div>


</div>
        </td>
    </tr>
</table>
</body>
</html>
