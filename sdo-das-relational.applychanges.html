<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <title>PHP Manual: Applies the changes made to a data graph back to the database.</title>

</head>
<body>
<table width="100%">
    <tr valign="top">
        <td style="font-size: smaller;" width="15%">
<style type="text/css">
#leftbar {
	float: left;
	width: 186px;
	padding: 5px;
	font-size: smaller;
}
ul.toc {
	margin: 0px 5px 5px 5px;
	padding: 0px;
}
ul.toc li {
	font-size: 85%;
	margin: 1px 0 1px 1px;
	padding: 1px 0 1px 11px;
	list-style-type: none;
	background-repeat: no-repeat;
	background-position: center left;
}
ul.toc li.header {
	font-size: 115%;
	padding: 5px 0px 5px 11px;
	border-bottom: 1px solid #cccccc;
	margin-bottom: 5px;
}
ul.toc li.active {
	font-weight: bold;
}
ul.toc li a {
	text-decoration: none;
}
ul.toc li a:hover {
	text-decoration: underline;
}
</style>
 <ul class="toc">
  <li class="header home"><a href="index.html">PHP Manual</a></li>
  <li class="header up"><a href="funcref.html">Function Reference</a></li>
  <li class="header up"><a href="refs.xml.html">XML Manipulation</a></li>
  <li class="header up"><a href="book.sdodasrel.html">SDO-DAS-Relational</a></li>
  <li class="header up"><a href="ref.sdodasrel.html">SDO-DAS-Relational Functions</a></li>
  <li class="active"><a href="sdo-das-relational.applychanges.html">SDO_DAS_Relational::applyChanges</a></li>
  <li><a href="sdo-das-relational.construct.html">SDO_DAS_Relational::__construct</a></li>
  <li><a href="sdo-das-relational.createrootdataobject.html">SDO_DAS_Relational::createRootDataObject</a></li>
  <li><a href="sdo-das-relational.executepreparedquery.html">SDO_DAS_Relational::executePreparedQuery</a></li>
  <li><a href="sdo-das-relational.executequery.html">SDO_DAS_Relational::executeQuery</a></li>
 </ul>

        </td>
        <td width="85%">
            <div style="text-align: center;">
                <div class="prev" style="text-align: left; float: left;"><a href="ref.sdodasrel.html">SDO-DAS-Relational Functions</a></div>
                <div class="next" style="text-align: right; float: right;"><a href="sdo-das-relational.construct.html">SDO_DAS_Relational::__construct</a></div>
                <div class="up"><a href="ref.sdodasrel.html">SDO-DAS-Relational Functions</a></div>
                <div class="home"><a href="index.html">PHP Manual</a></div>
            </div><hr/>
<div id="sdo-das-relational.applychanges" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">SDO_DAS_Relational::applyChanges</h1>
  <p class="refpurpose">
   Applies the changes made to a data graph back to the database.
  </p>
 </div>

 <div class="refsect1 description" id="refsect1-sdo-das-relational.applychanges-description">
  <h3 class="title">Description</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">void</span>
    <span class="methodname">SDO_DAS_Relational::applyChanges</span>
    ( <span class="methodparam">
    <span class="type">PDO</span>
     <code class="parameter">$database_handle</code>
   </span>
   , <span class="methodparam">
    <span class="type">SDODataObject</span>
     <code class="parameter">$root_data_object</code>
   </span>
   )</div>


  <div class="warning"><strong class="warning">Warning</strong><p class="simpara">This function is
<em class="emphasis">EXPERIMENTAL</em>. The behaviour of this function, its name, and
surrounding documentation may change without notice in a future release of PHP.
This function should be used at your own risk.
</p></div>

  <p class="para">
   Given a PDO database handle and the special root object of a data graph, 
   examine the change summary in the datagraph and applies the changes 
   to the database.
   The changes that it can apply can be creations of data objects, 
   deletes of data objects, and modifications to properties of data objects.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-sdo-das-relational.applychanges-parameters">
  <h3 class="title">Parameters</h3>
  <p class="para">
   <dl>

    
     <dt>
PDO_database_handle</dt>

     <dd>

      <p class="para">
       Constructed using the PDO extension. 
       A typical line to construct a PDO database handle might look like this:
       <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
$dbh&nbsp;=&nbsp;new&nbsp;PDO("mysql:dbname=COMPANYDB;host=localhost",DATABASE_USER,DATABASE_PASSWORD);</span>
</code></div>
       </div>

      </p>
     </dd>

    
    
     <dt>
root_data_object</dt>

     <dd>

      <p class="para">
       The special root object which is at the top of every SDO data graph.
      </p>
     </dd>

    
   </dl>

  </p>
 </div>


 <div class="refsect1 returnvalues" id="refsect1-sdo-das-relational.applychanges-returnvalues">
  <h3 class="title">Return Values</h3>
  <p class="para">
   None.
   Note however that the datagraph that was passed is still intact and usable.
   Furthermore, if data objects were created and written back to a 
   table with autogenerated primary keys, 
   then those primary keys will now be set in the data objects.
   If the changes were successfully written, 
   then the change summary associated with the datagraph will 
   have been cleared, 
   so that it is possible to now make further changes to the 
   data graph and apply those changes in turn.
   In this way it is possible to work with the same data graph 
   and apply changes repeatedly.
  </p>
 </div>




 <div class="refsect1 errors" id="refsect1-sdo-das-relational.applychanges-errors">
  <h3 class="title">Errors/Exceptions</h3>
  <p class="para">
   <span class="function">SDO_DAS_Relational::applyChanges</span>
   can throw an <span class="classname">SDO_DAS_Relational_Exception</span> if it is 
   unable to apply all the changes correctly.
  </p>
  <p class="para">
   The Relational DAS starts a database transaction before 
   beginning to apply the changes and will commit 
   the transaction only if they are all successful.
   The Relational DAS generates qualified update and delete statements 
   which contain a where clause that specifies that the row to be 
   updated or deleted must contain the same values that it did 
   when the data was first retrieved.
   This is how the optimistic concurrency is implemented.
   If any of the qualified update or delete statements fails to update or 
   delete their target row, it may be because the data has been altered 
   in the database in the meantime.
   In any event, if any update fails for any reason, 
   the transaction is rolled back and an exception thrown.
   The exception will contain the generated SQL statement that failed.
  </p>
  
  <p class="para">
   The Relational DAS also catches any PDO exceptions and obtains PDO 
   diagnostic information which it includes in an 
   <span class="classname">SDO_DAS_Relational_Exception</span> which it then throws.
  </p>
 </div>


 <div class="refsect1 examples" id="refsect1-sdo-das-relational.applychanges-examples">
  <h3 class="title">Examples</h3>
  <p class="para">
   Please see the
   <a href="sdodasrel.examples.html" class="link">Examples</a>
   section in the general information about the Relational DAS
   for many examples of calling this method.
   Please see also the section on
   <a href="sdodasrel.configuration.html#sdodasrel.tracing" class="link">Tracing</a>
   to see how you can see what SQL statements are 
   generated by the Relational DAS.
  </p>
 </div>

</div>
        </td>
    </tr>
</table>
</body>
</html>
